# ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

```
google-calendar-mcp-bot/
â”‚
â”œâ”€â”€ ðŸ“‚ bot/                          # ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° Ð±Ð¾Ñ‚Ð°
â”‚   â”œâ”€â”€ bot_instance.py              # Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð±Ð¾Ñ‚Ð° Ð¸ Ð´Ð¸ÑÐ¿ÐµÑ‚Ñ‡ÐµÑ€Ð°
â”‚   â”œâ”€â”€ mcp_client.py                # ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð´Ð»Ñ Google Calendar (MCP)
â”‚   â””â”€â”€ tasks_client.py              # ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð´Ð»Ñ Google Tasks (API)
â”‚
â”œâ”€â”€ ðŸ“‚ handlers/                     # ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÐºÐ¾Ð¼Ð°Ð½Ð´
â”‚   â”œâ”€â”€ common_handlers.py           # /start, /help
â”‚   â”œâ”€â”€ calendar_handlers.py         # Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ (ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ ÑÐ·Ñ‹Ðº)
â”‚   â”œâ”€â”€ tasks_handlers.py            # Ð—Ð°Ð´Ð°Ñ‡Ð¸ (ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹)
â”‚   â””â”€â”€ combined_handlers.py         # ÐšÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€
â”‚
â”œâ”€â”€ ðŸ“‚ utils/                        # Ð£Ñ‚Ð¸Ð»Ð¸Ñ‚Ñ‹
â”‚   â”œâ”€â”€ date_parser.py               # ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ Ñ€ÑƒÑÑÐºÐ¸Ñ… Ð´Ð°Ñ‚ Ð¸ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
â”‚   â”œâ”€â”€ formatters.py                # Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹
â”‚   â””â”€â”€ tasks_formatter.py           # Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡
â”‚
â”œâ”€â”€ ðŸ“‚ config/                       # ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
â”‚   â””â”€â”€ settings.py                  # ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
â”‚
â”œâ”€â”€ ðŸ“‚ tests/                        # ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ‚ÐµÑÑ‚Ñ‹
â”‚   â””â”€â”€ test_bot.py                  # Ð¢ÐµÑÑ‚Ñ‹ Ð²ÑÐµÑ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
â”‚
â”œâ”€â”€ ðŸ“‚ credentials/                  # OAuth credentials (Ð½Ðµ Ð² git)
â”‚   â”œâ”€â”€ google_credentials.json      # OAuth credentials Ð¾Ñ‚ Google
â”‚   â””â”€â”€ token.json                   # Ð¢Ð¾ÐºÐµÐ½Ñ‹ MCP ÑÐµÑ€Ð²ÐµÑ€Ð°
â”‚
â”œâ”€â”€ ðŸ“‚ logs/                         # Ð›Ð¾Ð³Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
â”‚
â”œâ”€â”€ ðŸ“„ main.py                       # Ð¢Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°
â”œâ”€â”€ ðŸ“„ requirements.txt              # Python Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
â”œâ”€â”€ ðŸ“„ .env                          # ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ (Ð½Ðµ Ð² git)
â”œâ”€â”€ ðŸ“„ .env_example                  # ÐŸÑ€Ð¸Ð¼ÐµÑ€ .env
â”‚
â”œâ”€â”€ ðŸ³ Dockerfile                    # Docker Ð¾Ð±Ñ€Ð°Ð·
â”œâ”€â”€ ðŸ³ docker-compose.yml            # Docker Compose ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
â”‚
â”œâ”€â”€ ðŸ”§ run.sh                        # Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð±Ð¾Ñ‚Ð°
â”œâ”€â”€ ðŸ”§ run_tests.sh                  # Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ñ‚ÐµÑÑ‚Ð¾Ð²
â”œâ”€â”€ ðŸ”§ reauth_tasks_only.py          # ÐŸÐµÑ€ÐµÐ°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Tasks API
â”‚
â””â”€â”€ ðŸ“š Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
    â”œâ”€â”€ README.md                    # Ð“Ð»Ð°Ð²Ð½Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
    â”œâ”€â”€ README_FIRST.txt             # Ð¡ Ñ‡ÐµÐ³Ð¾ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ (ASCII)
    â”œâ”€â”€ QUICKSTART.md                # Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚
    â”œâ”€â”€ EXAMPLES.md                  # ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ ÐºÐ¾Ð¼Ð°Ð½Ð´
    â”œâ”€â”€ FAQ.md                       # Ð§Ð°ÑÑ‚Ñ‹Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹
    â”œâ”€â”€ TESTING.md                   # Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
    â”œâ”€â”€ CHANGELOG.md                 # Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
    â”œâ”€â”€ PROJECT_STRUCTURE.md         # Ð­Ñ‚Ð¾Ñ‚ Ñ„Ð°Ð¹Ð»
    â””â”€â”€ LICENSE                      # MIT License
```

## ðŸ“ ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¼Ð¾Ð´ÑƒÐ»ÐµÐ¹

### Bot
- **bot_instance.py** - ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±Ð¾Ñ‚Ð°, Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ handlers, Ð·Ð°Ð¿ÑƒÑÐº polling
- **mcp_client.py** - Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ñ Google Calendar Ñ‡ÐµÑ€ÐµÐ· MCP ÑÐµÑ€Ð²ÐµÑ€
- **tasks_client.py** - Ð¿Ñ€ÑÐ¼Ð¾Ð¹ API Ð´Ð»Ñ Google Tasks

### Handlers
- **common_handlers.py** - Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ (/start, /help)
- **calendar_handlers.py** - ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ/Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€/ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹
- **tasks_handlers.py** - ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ/ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ/Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡
- **combined_handlers.py** - /today_all, /week_all

### Utils
- **date_parser.py** - Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³ "Ð·Ð°Ð²Ñ‚Ñ€Ð°", "15 ÑÐ½Ð²Ð°Ñ€Ñ", "Ð¿Ð¾Ð½ÐµÐ´ÐµÐ»ÑŒÐ½Ð¸Ðº"
- **formatters.py** - Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð´Ð»Ñ Telegram
- **tasks_formatter.py** - Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡ Ð¸ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°

### Tests
- **test_bot.py** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ‚ÐµÑÑ‚Ñ‹ Ð²ÑÐµÑ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹

## ðŸ”§ ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ

### .env
```bash
TELEGRAM_BOT_TOKEN=your_token_here
```

### credentials/google_credentials.json
OAuth 2.0 Client ID Ð¸Ð· Google Cloud Console

### ~/.config/google-calendar-mcp/
- `token.json` - Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Calendar (MCP)
- `tasks_token.json` - Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Tasks (API)

## ðŸ³ Docker

### Dockerfile
- Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ð¾Ð±Ñ€Ð°Ð·: `python:3.12-slim`
- Node.js Ð´Ð»Ñ MCP ÑÐµÑ€Ð²ÐµÑ€Ð°
- Ð’ÑÐµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹

### docker-compose.yml
- Ð¡ÐµÑ€Ð²Ð¸Ñ `bot`
- ÐœÐ¾Ð½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ `credentials/`
- ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
- Restart policy

## ðŸ“Š Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸

### Python (requirements.txt)
```
aiogram==3.16.0
pydantic>=2.4.1,<2.11
python-dotenv==1.0.0
pytz==2024.1
mcp==1.0.0
google-auth==2.36.0
google-auth-oauthlib==1.2.1
google-api-python-client==2.156.0
```

### Node.js
```
@cocal/google-calendar-mcp (global)
```

## ðŸš€ Ð¢Ð¾Ñ‡ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð°

### Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº
```bash
./run.sh
```
Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚: `venv/bin/python main.py`

### Docker
```bash
docker compose up -d
```

### Ð¢ÐµÑÑ‚Ñ‹
```bash
./run_tests.sh
```
Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚: `python tests/test_bot.py`

## ðŸ“ Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ (.gitignore)

- `venv/` - Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ
- `.env` - Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
- `credentials/` - OAuth credentials
- `logs/` - Ð»Ð¾Ð³Ð¸
- `google-cloud-sdk/` - Google Cloud CLI
- `__pycache__/` - Python ÐºÐµÑˆ
- `*.log` - Ñ„Ð°Ð¹Ð»Ñ‹ Ð»Ð¾Ð³Ð¾Ð²

## ðŸ” Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ

### ÐŸÑ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ (Ð½Ðµ Ð² git):
- `.env`
- `credentials/google_credentials.json`
- `credentials/token.json`
- `~/.config/google-calendar-mcp/*.json`

### ÐŸÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹:
- Ð’ÐµÑÑŒ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´
- Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ
- Docker ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
- `.env_example`

## ðŸ“ˆ Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

### Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ:
1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ handler Ð² `handlers/`
2. Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð² `bot/bot_instance.py`
3. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² `/help` Ð² `common_handlers.py`

### Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ API:
1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð² `bot/`
2. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹
3. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð² handlers

### Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ð´Ð°Ñ‚Ñ‹:
1. ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ `utils/date_parser.py`
2. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² ÑÐ»Ð¾Ð²Ð°Ñ€ÑŒ Ð¸Ð»Ð¸ regex
3. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ‚ÐµÑÑ‚
